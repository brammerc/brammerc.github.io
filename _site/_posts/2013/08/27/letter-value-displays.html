<!DOCTYPE html>
<html lang="en-us">

  <head>
  <link href="http://gmpg.org/xfn/11" rel="profile">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta http-equiv="content-type" content="text/html; charset=utf-8">
  <meta name="keywords" content="swimming performance, data analysis, statistics, data visualization" />
  <meta name="author" content='Chris Brammer' />
  <meta name="description" content="Website of Chris Brammer" />
  <!-- Enable responsiveness on mobile devices-->
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1">

  <title>
    
      Letter Value Displays &middot; Human Performance Analytics
    
  </title>

  <!-- CSS -->
  <link rel="stylesheet" href="/public/css/poole.css">
  <link rel="stylesheet" href="/public/css/syntax.css">
  <link rel="stylesheet" href="/public/css/hyde.css">
  <link rel="stylesheet" href="http://fonts.googleapis.com/css?family=PT+Sans:400,400italic,700|Abril+Fatface">

  <!-- Icons -->
  <link rel="shortcut icon" href="/public/icon/favicon.ico">    
  <link rel="apple-touch-icon" sizes="57x57" href="/public/icon/apple-icon-57x57.png">
  <link rel="apple-touch-icon" sizes="60x60" href="/public/icon/apple-icon-60x60.png">
  <link rel="apple-touch-icon" sizes="72x72" href="/public/icon/apple-icon-72x72.png">
  <link rel="apple-touch-icon" sizes="76x76" href="/public/icon/apple-icon-76x76.png">
  <link rel="apple-touch-icon" sizes="114x114" href="/public/icon/apple-icon-114x114.png">
  <link rel="apple-touch-icon" sizes="120x120" href="/public/icon/apple-icon-120x120.png">
  <link rel="apple-touch-icon" sizes="144x144" href="/public/icon/apple-icon-144x144.png">
  <link rel="apple-touch-icon" sizes="152x152" href="/public/icon/apple-icon-152x152.png">
  <link rel="apple-touch-icon" sizes="180x180" href="/public/icon/apple-icon-180x180.png">
  <link rel="icon" type="image/png" sizes="192x192"  href="/public/icon/android-icon-192x192.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/public/icon/favicon-32x32.png">
  <link rel="icon" type="image/png" sizes="96x96" href="/public/icon/favicon-96x96.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/public/icon/favicon-16x16.png">
  <link rel="manifest" href="/public/icon/manifest.json">
  <!-- <link rel="apple-touch-icon-precomposed" sizes="144x144" href="/public/apple-touch-icon-144-precomposed.png">
  <link rel="shortcut icon" href="/public/favicon.ico"> -->

  <!-- RSS -->
  <link rel="alternate" type="application/rss+xml" title="RSS" href="/atom.xml">
</head>


  <body class="theme-base-0d">

    <div class="sidebar">
  <div class="container sidebar-sticky">
    <div class="sidebar-about">
      <h1>
        <a href="/">
          Human Performance Analytics
        </a>
      </h1>
      <p class="lead">A data science blog dedicated to enlightening and informing those with a vested interest in health, physical fitness, and sport.</p>
    </div>

    <nav class="sidebar-nav">
      <a class="sidebar-nav-item" href="/">Blog Home</a>

      
      <a class="sidebar-nav-item" href="/author">Author</a>
      <a class="sidebar-nav-item" href="/research">Research</a>
      
    </nav>

    <p>&copy; 2016. <a href="/">Chris Brammer</a>. All contents under 
	<a href="http://creativecommons.org/licenses/by-nc-sa/4.0/" target="_blank">(CC) BY-NC-SA license</a>, 
	unless otherwise noted.</p>
  </div>
</div>


    <div class="content container">
      <div class="post">
  <h1 >Letter Value Displays</h1>
  <span class="post-date">27 Aug 2013</span>
  <p>The default graphical display of most plotting functions in R is very limited (and usually not very pretty). But that doesn’t mean that we should conform with those crude figures.</p>

<!--more-->

<p><img src="/images/blog/density-plot-post.png" alt="" /></p>

<h3 id="a-basic-plot-example">A Basic Plot Example</h3>

<p>For this post I’ll use a simple example by plotting density curves of some random generated variables. For instance, let’s generate three normal distributions with different parameters, and their corresponding estimated densities:</p>

<figure class="highlight"><pre><code class="language-r" data-lang="r"><span class="c1"># setting seed for random numbers
</span><span class="n">set.seed</span><span class="p">(</span><span class="m">1111</span><span class="p">)</span><span class="w">

</span><span class="c1"># random normal variables
</span><span class="n">var1</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">rnorm</span><span class="p">(</span><span class="m">500</span><span class="p">)</span><span class="w">
</span><span class="n">var2</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">rnorm</span><span class="p">(</span><span class="m">500</span><span class="p">,</span><span class="w"> </span><span class="m">1</span><span class="p">,</span><span class="w"> </span><span class="m">1.5</span><span class="p">)</span><span class="w">
</span><span class="n">var3</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">rnorm</span><span class="p">(</span><span class="m">500</span><span class="p">,</span><span class="w"> </span><span class="m">-1</span><span class="p">,</span><span class="w"> </span><span class="m">1.5</span><span class="p">)</span><span class="w">

</span><span class="c1"># densities
</span><span class="n">den1</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">density</span><span class="p">(</span><span class="n">var1</span><span class="p">)</span><span class="w">
</span><span class="n">den2</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">density</span><span class="p">(</span><span class="n">var2</span><span class="p">)</span><span class="w">
</span><span class="n">den3</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">density</span><span class="p">(</span><span class="n">var3</span><span class="p">)</span></code></pre></figure>

<p>We can plot each of the densities with the function <code class="highlighter-rouge">plot()</code> which displays a very raw figure. These displays are good for quick visual inspection, but they are very limited for anything else (especially if we plan to include them in some slides for presentation purposes)</p>

<figure class="highlight"><pre><code class="language-r" data-lang="r"><span class="c1"># individual density plots
</span><span class="n">plot</span><span class="p">(</span><span class="n">den1</span><span class="p">)</span><span class="w">
</span><span class="n">plot</span><span class="p">(</span><span class="n">den2</span><span class="p">)</span><span class="w">
</span><span class="n">plot</span><span class="p">(</span><span class="n">den3</span><span class="p">)</span></code></pre></figure>

<p><img src="/figs/code-2014-08-16-Density-Curves/plot-density1-1.png" alt="center" /></p>

<p><img src="/figs/code-2014-08-16-Density-Curves/plot-density2-1.png" alt="center" /></p>

<p><img src="/figs/code-2014-08-16-Density-Curves/plot-density3-1.png" alt="center" /></p>

<h3 id="improved-plots">Improved Plots</h3>

<p>Of course, we can write some lines of code to substantially improve our graphics. First, let’s define some colors for each distribution using the function <code class="highlighter-rouge">hsv()</code></p>

<figure class="highlight"><pre><code class="language-r" data-lang="r"><span class="c1"># colors for each distribution
</span><span class="n">col1</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">hsv</span><span class="p">(</span><span class="n">h</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">0.65</span><span class="p">,</span><span class="w"> </span><span class="n">s</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">0.6</span><span class="p">,</span><span class="w"> </span><span class="n">v</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">0.8</span><span class="p">,</span><span class="w"> </span><span class="n">alpha</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">0.5</span><span class="p">)</span><span class="w">
</span><span class="n">col2</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">hsv</span><span class="p">(</span><span class="n">h</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">0.85</span><span class="p">,</span><span class="w"> </span><span class="n">s</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">0.6</span><span class="p">,</span><span class="w"> </span><span class="n">v</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">0.8</span><span class="p">,</span><span class="w"> </span><span class="n">alpha</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">0.5</span><span class="p">)</span><span class="w">
</span><span class="n">col3</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">hsv</span><span class="p">(</span><span class="n">h</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">0.55</span><span class="p">,</span><span class="w"> </span><span class="n">s</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">0.6</span><span class="p">,</span><span class="w"> </span><span class="n">v</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">0.8</span><span class="p">,</span><span class="w"> </span><span class="n">alpha</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">0.5</span><span class="p">)</span></code></pre></figure>

<p>And now let’s combine them in a single graphic tweaking the right parameters to produce a visually aesthetic plot:</p>

<figure class="highlight"><pre><code class="language-r" data-lang="r"><span class="c1"># set graphic margins
</span><span class="n">op</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">par</span><span class="p">(</span><span class="n">mar</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">c</span><span class="p">(</span><span class="m">3</span><span class="p">,</span><span class="w"> </span><span class="m">3</span><span class="p">,</span><span class="w"> </span><span class="m">2</span><span class="p">,</span><span class="w"> </span><span class="m">2</span><span class="p">))</span><span class="w">
</span><span class="c1"># call new plot
</span><span class="n">plot.new</span><span class="p">()</span><span class="w">
</span><span class="c1"># plot window
</span><span class="n">plot.window</span><span class="p">(</span><span class="n">xlim</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">c</span><span class="p">(</span><span class="m">-6</span><span class="p">,</span><span class="m">6</span><span class="p">),</span><span class="w"> </span><span class="n">ylim</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">c</span><span class="p">(</span><span class="m">0</span><span class="p">,</span><span class="m">0.4</span><span class="p">))</span><span class="w">
</span><span class="c1"># add axes
</span><span class="n">axis</span><span class="p">(</span><span class="n">side</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">1</span><span class="p">,</span><span class="w"> </span><span class="n">pos</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">0</span><span class="p">,</span><span class="w"> </span><span class="n">at</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">seq</span><span class="p">(</span><span class="n">from</span><span class="o">=</span><span class="m">-6</span><span class="p">,</span><span class="w"> </span><span class="n">to</span><span class="o">=</span><span class="m">6</span><span class="p">,</span><span class="w"> </span><span class="n">by</span><span class="o">=</span><span class="m">2</span><span class="p">),</span><span class="w"> </span><span class="n">col</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"gray20"</span><span class="p">,</span><span class="w"> 
     </span><span class="n">lwd.ticks</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">0.25</span><span class="p">,</span><span class="w"> </span><span class="n">cex.axis</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">1</span><span class="p">,</span><span class="w"> </span><span class="n">col.axis</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"gray20"</span><span class="p">,</span><span class="w"> </span><span class="n">lwd</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">1.5</span><span class="p">)</span><span class="w">
</span><span class="n">axis</span><span class="p">(</span><span class="n">side</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">2</span><span class="p">,</span><span class="w"> </span><span class="n">pos</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">-6</span><span class="p">,</span><span class="w"> </span><span class="n">at</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">seq</span><span class="p">(</span><span class="n">from</span><span class="o">=</span><span class="m">0</span><span class="p">,</span><span class="w"> </span><span class="n">to</span><span class="o">=</span><span class="m">0.4</span><span class="p">,</span><span class="w"> </span><span class="n">by</span><span class="o">=</span><span class="m">0.1</span><span class="p">),</span><span class="w"> </span><span class="n">col</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"gray20"</span><span class="p">,</span><span class="w">
     </span><span class="n">las</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">2</span><span class="p">,</span><span class="w"> </span><span class="n">lwd.ticks</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">0.5</span><span class="p">,</span><span class="w"> </span><span class="n">cex.axis</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">1</span><span class="p">,</span><span class="w"> </span><span class="n">col.axis</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"gray20"</span><span class="p">,</span><span class="w"> </span><span class="n">lwd</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">1.5</span><span class="p">)</span><span class="w">
</span><span class="c1"># density 1
</span><span class="n">polygon</span><span class="p">(</span><span class="n">den1</span><span class="o">$</span><span class="n">x</span><span class="p">,</span><span class="w"> </span><span class="n">den1</span><span class="o">$</span><span class="n">y</span><span class="p">,</span><span class="w"> </span><span class="n">col</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">col1</span><span class="p">,</span><span class="w"> </span><span class="n">border</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">col1</span><span class="p">)</span><span class="w">
</span><span class="c1"># density 2
</span><span class="n">polygon</span><span class="p">(</span><span class="n">den2</span><span class="o">$</span><span class="n">x</span><span class="p">,</span><span class="w"> </span><span class="n">den2</span><span class="o">$</span><span class="n">y</span><span class="p">,</span><span class="w"> </span><span class="n">col</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">col2</span><span class="p">,</span><span class="w"> </span><span class="n">border</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">col2</span><span class="p">)</span><span class="w">
</span><span class="c1"># density 3
</span><span class="n">polygon</span><span class="p">(</span><span class="n">den3</span><span class="o">$</span><span class="n">x</span><span class="p">,</span><span class="w"> </span><span class="n">den3</span><span class="o">$</span><span class="n">y</span><span class="p">,</span><span class="w"> </span><span class="n">col</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">col3</span><span class="p">,</span><span class="w"> </span><span class="n">border</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">col3</span><span class="p">)</span><span class="w">
</span><span class="c1"># add legends
</span><span class="n">text</span><span class="p">(</span><span class="m">1.3</span><span class="p">,</span><span class="w"> </span><span class="m">0.35</span><span class="p">,</span><span class="w"> </span><span class="n">labels</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"Normal(0, 1)"</span><span class="p">,</span><span class="w"> </span><span class="n">col</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"gray30"</span><span class="p">,</span><span class="w"> </span><span class="n">cex</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">0.9</span><span class="p">)</span><span class="w">
</span><span class="n">text</span><span class="p">(</span><span class="m">3.8</span><span class="p">,</span><span class="w"> </span><span class="m">0.15</span><span class="p">,</span><span class="w"> </span><span class="n">labels</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"Normal(1, 1.5)"</span><span class="p">,</span><span class="w"> </span><span class="n">col</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"gray30"</span><span class="p">,</span><span class="w"> </span><span class="n">cex</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">0.9</span><span class="p">)</span><span class="w">
</span><span class="n">text</span><span class="p">(</span><span class="m">-3.6</span><span class="p">,</span><span class="w"> </span><span class="m">0.15</span><span class="p">,</span><span class="w"> </span><span class="n">labels</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"Normal(-1, 1.5)"</span><span class="p">,</span><span class="w"> </span><span class="n">col</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"gray30"</span><span class="p">,</span><span class="w"> </span><span class="n">cex</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">0.9</span><span class="p">)</span><span class="w">
</span><span class="c1"># turn off par
</span><span class="n">par</span><span class="p">(</span><span class="n">op</span><span class="p">)</span></code></pre></figure>

<p><img src="/figs/code-2014-08-16-Density-Curves/density-plot-1.png" alt="center" /></p>

<h3 id="using-ggplot2">Using ggplot2</h3>

<p>We can also use the package <code class="highlighter-rouge">"ggplot2"</code> to obtain a similar graphic. Here’s how:</p>

<figure class="highlight"><pre><code class="language-r" data-lang="r"><span class="c1"># data frame with normal variables
</span><span class="n">distribs</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">data.frame</span><span class="p">(</span><span class="w">
  </span><span class="n">values</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">c</span><span class="p">(</span><span class="n">var1</span><span class="p">,</span><span class="w"> </span><span class="n">var2</span><span class="p">,</span><span class="w"> </span><span class="n">var3</span><span class="p">),</span><span class="w">
  </span><span class="n">type</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">gl</span><span class="p">(</span><span class="n">n</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">3</span><span class="p">,</span><span class="w"> </span><span class="n">k</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">500</span><span class="p">))</span><span class="w">

</span><span class="c1"># load ggplot2
</span><span class="n">library</span><span class="p">(</span><span class="n">ggplot2</span><span class="p">)</span><span class="w">

</span><span class="c1"># plot
</span><span class="n">ggplot</span><span class="p">(</span><span class="n">data</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">distribs</span><span class="p">,</span><span class="w"> </span><span class="n">aes</span><span class="p">(</span><span class="n">x</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">values</span><span class="p">,</span><span class="w"> </span><span class="n">group</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">type</span><span class="p">))</span><span class="w"> </span><span class="o">+</span><span class="w">
  </span><span class="n">geom_density</span><span class="p">(</span><span class="n">aes</span><span class="p">(</span><span class="n">fill</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">type</span><span class="p">,</span><span class="w"> </span><span class="n">color</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">type</span><span class="p">),</span><span class="w"> </span><span class="n">alpha</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">0.5</span><span class="p">)</span></code></pre></figure>

<p><img src="/figs/code-2014-08-16-Density-Curves/density-ggplot-1.png" alt="center" /></p>

  <div class="previous">
  
	  <a href="/_posts/2012/02/07/example-content.html" title="Previous post">&larr; older</a>
	
</div>
<div class="archive">
	<a href="/blog/archive/" title="an archive of all posts">see all posts<!-- &rarr;--></a>
</div>
<div class="next">
	
	  <a href="/_posts/2013/09/27/density-plots.html" title="Next post">newer &rarr;</a>
	
</div>
</div>
<!--<div id="holder">
    <div class="headernav-post">
      <div class="previous">
  
	  <a href="/_posts/2012/02/07/example-content.html" title="Previous post">&larr; older</a>
	
</div>
<div class="archive">
	<a href="/blog/archive/" title="an archive of all posts">see all posts<!-- &rarr;--></a>
</div>
<div class="next">
	
	  <a href="/_posts/2013/09/27/density-plots.html" title="Next post">newer &rarr;</a>
	
</div>
    </div>
</div> -->
<div class="related">
  <h2>Related Posts</h2>
  <ul class="related-posts">
    
      <li>
        <h3>
          <a href="/_posts/2016/06/05/lm.html">
            The Linear Model Explained
            <small>05 Jun 2016</small>
          </a>
        </h3>
      </li>
    
      <li>
        <h3>
          <a href="/_posts/2014/04/26/hrv-vo2max.html">
            Hear rate variability during exercise
            <small>26 Apr 2014</small>
          </a>
        </h3>
      </li>
    
      <li>
        <h3>
          <a href="/_posts/2013/12/28/introducing-hyde.html">
            Introducing Hyde
            <small>28 Dec 2013</small>
          </a>
        </h3>
      </li>
    
  </ul>
</div>

    </div>

  </body>
</html>
